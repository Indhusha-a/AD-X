<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>AD-X - Submit Review</title>
  <link href="/css/style.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    .review-header {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      padding: 40px 0;
      text-align: center;
    }
    .review-container {
      max-width: 600px;
      margin: 40px auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      padding: 30px;
    }
    .product-info {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 25px;
      border-left: 4px solid #28a745;
    }
    .rating-stars {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      justify-content: center;
    }
    .star {
      font-size: 2.5rem;
      color: #ddd;
      cursor: pointer;
      transition: color 0.2s ease;
    }
    .star:hover,
    .star.active {
      color: #ffc107;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 14px;
      resize: vertical;
      min-height: 120px;
    }
    .char-count {
      text-align: right;
      font-size: 0.8rem;
      color: #6c757d;
      margin-top: 5px;
    }
  </style>
</head>
<body>
<!-- Navigation Header -->
<nav class="navbar">
  <div class="container">
    <a class="navbar-brand" href="/">ðŸš€ AD-X</a>
    <div class="navbar-nav">
      <a href="/buyer/dashboard" class="btn btn-outline-primary me-2">
        <i class="bi bi-speedometer"></i> Dashboard
      </a>
      <a class="btn btn-secondary" href="/logout">
        <i class="bi bi-box-arrow-right"></i> Logout
      </a>
    </div>
  </div>
</nav>

<!-- Review Header -->
<div class="review-header">
  <div class="container">
    <h1><i class="bi bi-star-fill"></i> Write a Review</h1>
    <p>Share your experience with this advertising service</p>
  </div>
</div>

<div class="container">
  <!-- Success/Error Messages -->
  <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
  <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

  <div class="review-container fade-in">
    <!-- Product Information -->
    <div class="product-info" th:if="${product}">
      <h4 th:text="${product.title}">Product Title</h4>
      <p style="margin: 5px 0; color: #666;" th:text="${product.category}">Category</p>
      <p style="margin: 0; color: #28a745; font-weight: bold;"
         th:text="'$' + ${#numbers.formatDecimal(product.price, 1, 2)}">$99.99</p>
    </div>

    <form th:action="@{/reviews/submit/{id}(id=${product.id})}" method="post">
      <!-- Rating Selection -->
      <div class="form-group">
        <label>Overall Rating</label>
        <div class="rating-stars">
          <span class="star" onclick="setRating(1)">â˜…</span>
          <span class="star" onclick="setRating(2)">â˜…</span>
          <span class="star" onclick="setRating(3)">â˜…</span>
          <span class="star" onclick="setRating(4)">â˜…</span>
          <span class="star" onclick="setRating(5)">â˜…</span>
        </div>
        <input type="hidden" id="rating" name="rating" value="" required>
        <div style="text-align: center; margin-top: 10px;">
          <small id="rating-text" style="color: #6c757d;">Select your rating</small>
        </div>
      </div>

      <!-- Review Comment -->
      <div class="form-group">
        <label for="comment">Your Review</label>
        <textarea id="comment" name="comment" placeholder="Share your experience with this advertising service. What did you like? What could be improved?"
                  maxlength="500" th:text="${comment}"></textarea>
        <div class="char-count">
          <span id="char-count">0</span>/500 characters
        </div>
      </div>

      <!-- Review Guidelines -->
      <div style="background: #e7f3ff; border-left: 4px solid #007bff; padding: 15px; margin: 20px 0; border-radius: 5px;">
        <h6 style="margin: 0 0 10px 0; color: #007bff;"><i class="bi bi-info-circle"></i> Review Guidelines</h6>
        <ul style="margin: 0; padding-left: 20px; font-size: 0.9rem;">
          <li>Be honest and specific about your experience</li>
          <li>Focus on the service quality and results</li>
          <li>Keep your review respectful and professional</li>
          <li>You can edit your review within 24 hours</li>
        </ul>
      </div>

      <!-- Submit Buttons -->
      <div style="display: flex; gap: 15px; justify-content: center;">
        <button type="submit" class="btn btn-success btn-lg">
          <i class="bi bi-check-circle"></i> Submit Review
        </button>
        <a th:href="@{/buyer/product/{id}(id=${product.id})}" class="btn btn-outline-secondary btn-lg">
          <i class="bi bi-arrow-left"></i> Back to Product
        </a>
      </div>
    </form>
  </div>
</div>

<!-- Footer -->
<footer class="footer">
  <div class="footer-content">
    <p>ðŸš€ <strong>AD-X Advertising Platform</strong> - Share Your Experience</p>
    <p>Â© 2024 AD-X. All rights reserved. | <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a></p>
    <p>Review System | Version 1.0.0</p>
  </div>
</footer>

<script>
  let currentRating = 0;

  function setRating(rating) {
    currentRating = rating;
    document.getElementById('rating').value = rating;

    // Update star display
    const stars = document.querySelectorAll('.star');
    stars.forEach((star, index) => {
      if (index < rating) {
        star.classList.add('active');
      } else {
        star.classList.remove('active');
      }
    });

    // Update rating text
    const ratingText = document.getElementById('rating-text');
    const texts = ['Select your rating', 'Poor', 'Fair', 'Good', 'Very Good', 'Excellent'];
    ratingText.textContent = texts[rating];
    ratingText.style.color = rating >= 4 ? '#28a745' : rating >= 3 ? '#ffc107' : '#dc3545';
  }

  // Character count for comment
  document.getElementById('comment').addEventListener('input', function(e) {
    const count = e.target.value.length;
    document.getElementById('char-count').textContent = count;

    if (count > 450) {
      document.getElementById('char-count').style.color = '#dc3545';
    } else if (count > 400) {
      document.getElementById('char-count').style.color = '#ffc107';
    } else {
      document.getElementById('char-count').style.color = '#28a745';
    }
  });

  // Form validation
  document.querySelector('form').addEventListener('submit', function(e) {
    if (currentRating === 0) {
      e.preventDefault();
      alert('Please select a rating');
      return false;
    }
  });
</script>
</body>
</html>